
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Status Update: splitting patches for mono flat - Virt Block</title>
	<meta name="author" content="Fam Zheng">

	
	<meta name="description" content="The big monolithic flat patch will be split into small ones, I have the split
in mind as: add VmdkExtent, and change any code that use the &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Virt Block" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>

<body>
	<header id="header" class="inner"><h1><a href="/">Virt Block</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:famz.github.io">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:famz.github.io">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner"><article class="post">
	<h2 class="title">Status Update: Splitting Patches for Mono Flat</h2>
	<div class="entry-content"><p>The big monolithic flat patch will be split into small ones, I have the split
in mind as:</p>

<!-- more -->


<ul>
<li>add <code>VmdkExtent</code>, and change any code that use the <code>BDRVVmdkState</code> structure to a single <code>VmdkExtent</code> manner.</li>
<li>probe <code>monolithicFlat</code> image.</li>
<li><code>vmdk_open</code> for <code>monolithicFlat</code>.</li>
<li><code>desc_offset</code> field in <code>BDRVVmdkState</code>.</li>
<li><code>vmdk_close</code> for both formats.</li>
<li><code>vmdk_read</code> and <code>vmdk_write</code> for <code>monolithicFlat</code>.</li>
<li><code>vmdk_create</code> and <code>vmdk_create_options</code> for <code>monolithicFlat</code>.</li>
<li><code>vmdk_flush</code> for both formats.</li>
<li><code>vmdk_is_allocated</code> for both formats.</li>
<li><code>update_cid</code> bug fix</li>
<li> indent, space and line width fix</li>
<li>bug fix: floor of offset in the function <code>get_whole_cluster</code></li>
</ul>


<p>The first patch is still very big, because the structure change influences
almost every function in the file. But fortunately it’s not very hard to split
by hand. I’ve had it done today and the following patches should be relatively
shorter, hope to finish it in Fri.</p>
</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-06-03T01:00:00+08:00" pubdate data-updated="true">Jun 3<span>rd</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/gsoc/'>gsoc</a>


</div>
	
		<div class="comments"><a href="/blog/2011/06/03/status-update-splitting-patches-for-mono-flat/#disqus_thread">Comments</a></div>
	
</div></article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>


</div>
	<footer id="footer" class="inner">Copyright &copy; 2013

    Fam Zheng

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






</body>
</html>